როდესაც ვიწყებთ უფრო რთული ლოგიკის მოდელირებას, უნდა გავართვათ თავი იმ პრობლემას, რომელიც დაკავშირებულია ბიზნეს-პროცესების მართვასთან, რომლებიც გადიან ინდივიდუალური სერვისების საზღვრებს. მიკროსერვისების შემთხვევაში, ეს პრობლემა უფრო მალე დაგვხვდება.

მომაგრე მაგალითი MusicCorp-ისგან, ახალი კლიენტის შექმნის პროცესზე:

1. კლიენტისათვის ახალი ჩანაწერი იქმნება ლოიალობის პუნქტების ანგარიშში.
    
2. ფოსტის სისტემა აგზავნის „welcome pack“-ს.
    
3. ვაგზავნით კლიენტს „welcome“ ელ-ფოსტას.
    

კონცეპტუალურად ეს მარტივად მოდელირდება ფლოჩარტის სახით.

პრაქტიკაში ამ პროცესის იმპლემენტაციისას, ორი არქიტექტურული სტილი შეგვიძლია ავირჩიოთ:

**ორკესტრაცია:**

ორკესტრაციის შემთხვევაში, ცენტრალური „მკვლევარი“ (central brain) აკონტროლებს პროცესს, როგორც ორკესტრის დირიჟორი. მაგალითად, კლიენტის სერვისი შეიძლება შესრულდეს როგორც ცენტრალური კონტროლერი: შექმნისას ის ურეკავს ლოიალობის პუნქტების სერვისს, ელ-ფოსტის სერვისს და ფოსტის სერვისს request/response-ით. კლიენტის სერვისი აკონტროლებს, სად არის პროცესი შექმნილია თუ არა ანგარიში, გაგზავნილია ელ-ფოსტა, გადაგზავნილია პოსტი. 

შესაძლებელია ფლოჩარტის პირდაპირი გადატანა კოდში, ან ამისთვის სპეციალური tooling-ის გამოყენება (მაგალითად, business process modeling software). სინქრონული request/response-ის შემთხვევაში, შესაძლებელია დავადგინოთ, წარმატებით შესრულდა თუ არა თითოეული ეტაპი.
![[Pasted image 20250907232910.png]]
##### ფიგურა 4-2

![[Pasted image 20250907233018.png]]
##### ფიგურა 4-3


**ჩანაცვლება (choreography):**

ქორეოგრაფიულ მიდგომაში, კლიენტის სერვისი ასინქრონულად გამოყოფს event-ს, მაგალითად, Customer created. ელ-ფოსტის სერვისი, ფოსტის სერვისი და ლოიალობის პუნქტების სერვისი უბრალოდ ამ ღონისძიებები-ს subscription-ს ახდენს და რეაგირებს შესაბამისად. ეს მნიშვნელოვნად უფრო decoupled მიდგომაა. თუ სხვა სერვისს სჭირდება კლიენტის შექმნის პროცესში ჩართვა, ის უბრალოდ events-ს აბონირდება. ხარვეზია, რომ ბიზნეს პროცესის explicit-ი ფლოჩარტის ხედვა მხოლოდ იმპლიციტურად აისახება სისტემაში.
![[Pasted image 20250907233212.png]]


ასე რომ, დამატებითი სამუშაოა საჭირო, რათა მონიტორინგი და პროცესის ტრეკინგი შესაძლებელი იყოს. მაგალითად, როგორ დავადგინოთ, რომ ლოიალობის პუნქტების სერვისში ბაგი არ მომხდარა და ანგარიში არ შეიქმნა? ერთ-ერთი მიდგომაა მონიტორინგის სისტემის შექმნა, რომელიც explicit-ად შეესაბამება ბიზნეს პროცესის ფლოჩარტს, მაგრამ აკონტროლებს თითოეული სერვისის ქმედებას დამოუკიდებლად.

შეჯამება: სისტემები, რომლებიც ქორეოგრაფიულ მიდგომას უფრო ეყრდნობიან, უფრო loosely coupled, მოქნილი და ცვლილებებისთვის მზად არიან. თუმცა, საჭიროა დამატებითი მონიტორინგი და პროცესების კონტროლი. ძალიან ორკესტრირებული სისტემები ხშირად მძიმედ მწყობრად, მაღალი ცვლილების ხარჯით გამოდიან.

ტექნიკური დეტალების არჩევა:

- სინქრონული გადაწყვეტილებები მარტივია, სწრაფად ჩანს, შესრულდა თუ არა.
    
- გრძელვადიანი პროცესებისთვის, შეგიძლიათ ასინქრონული request-ები და callback-ები გამოიყენოთ.
    
- ასინქრონული event-ები ხელს უწყობს ქორეოგრაფიულ მიდგომას, რაც უზრუნველყოფს უფრო decoupled სერვისებს — მიზანი, რომელიც სერვისების დამოუკიდებელი განთავსებისათვის მნიშვნელოვანია.
    

შეუძლებელია მორგება და კომბინაცია — ზოგი ტექნოლოგია ბუნებრივად ერგება request/response ან event-based სტილს. ამის გასაგებად აუცილებელია ტექნიკური დეტალების გაცნობა.